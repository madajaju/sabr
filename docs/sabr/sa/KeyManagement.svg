<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1225px" preserveAspectRatio="none" style="width:1451px;height:1225px;" version="1.1" viewBox="0 0 1451 1225" width="1451px" zoomAndPan="magnify"><defs><filter height="300%" id="fow1z5arkmd7j" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fow1z5arkmd7j)" height="1103.1563" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="292.5" y="71.9609"/><rect fill="#FFFFFF" filter="url(#fow1z5arkmd7j)" height="1072.8047" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="434" y="102.3125"/><rect fill="#FFFFFF" filter="url(#fow1z5arkmd7j)" height="64.9609" style="stroke: #000000; stroke-width: 2.0;" width="322.5" x="359" y="117.3125"/><rect fill="#90EE90" filter="url(#fow1z5arkmd7j)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="59" x="608.5" y="135.6641"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="615.5" y="157.1973">SABR1</text><rect fill="#FFFFFF" filter="url(#fow1z5arkmd7j)" height="92.0547" style="stroke: #000000; stroke-width: 2.0;" width="1035" x="91" y="1031.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="49" x2="49" y1="39.6094" y2="1184.1172"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="163" x2="163" y1="39.6094" y2="1184.1172"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="297" x2="297" y1="39.6094" y2="1184.1172"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="439" x2="439" y1="39.6094" y2="1184.1172"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="639.5" x2="639.5" y1="168.9688" y2="1184.1172"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1047.5" x2="1047.5" y1="39.6094" y2="1184.1172"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1139.5" x2="1139.5" y1="39.6094" y2="1184.1172"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1250.5" x2="1250.5" y1="39.6094" y2="1184.1172"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1340.5" x2="1340.5" y1="39.6094" y2="1184.1172"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1406.5" x2="1406.5" y1="39.6094" y2="1184.1172"/><rect fill="#FEFECE" filter="url(#fow1z5arkmd7j)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="79" x="8" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="65" x="15" y="24.5332">Developer</text><rect fill="#FEFECE" filter="url(#fow1z5arkmd7j)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="79" x="8" y="1183.1172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="65" x="15" y="1204.6504">Developer</text><rect fill="#FFC0CB" filter="url(#fow1z5arkmd7j)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="121" x="101" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="108" y="24.5332">SecurityManager</text><rect fill="#FFC0CB" filter="url(#fow1z5arkmd7j)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="121" x="101" y="1183.1172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="108" y="1204.6504">SecurityManager</text><rect fill="#00AAFF" filter="url(#fow1z5arkmd7j)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="119" x="236" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="105" x="243" y="24.5332">DevOps Pipeline</text><rect fill="#00AAFF" filter="url(#fow1z5arkmd7j)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="119" x="236" y="1183.1172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="105" x="243" y="1204.6504">DevOps Pipeline</text><rect fill="#90EE90" filter="url(#fow1z5arkmd7j)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="136" x="369" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="122" x="376" y="24.5332">Capability Manager</text><rect fill="#90EE90" filter="url(#fow1z5arkmd7j)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="136" x="369" y="1183.1172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="122" x="376" y="1204.6504">Capability Manager</text><rect fill="#90EE90" filter="url(#fow1z5arkmd7j)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="59" x="608.5" y="1183.1172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="615.5" y="1204.6504">SABR1</text><rect fill="#90EE90" filter="url(#fow1z5arkmd7j)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="59" x="1016.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="1023.5" y="24.5332">SABR2</text><rect fill="#90EE90" filter="url(#fow1z5arkmd7j)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="59" x="1016.5" y="1183.1172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="1023.5" y="1204.6504">SABR2</text><rect fill="#90EE90" filter="url(#fow1z5arkmd7j)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1089.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="1096.5" y="24.5332">DataStream1</text><rect fill="#90EE90" filter="url(#fow1z5arkmd7j)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1089.5" y="1183.1172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="1096.5" y="1204.6504">DataStream1</text><rect fill="#90EE90" filter="url(#fow1z5arkmd7j)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1200.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="1207.5" y="24.5332">DataStream2</text><rect fill="#90EE90" filter="url(#fow1z5arkmd7j)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1200.5" y="1183.1172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="1207.5" y="1204.6504">DataStream2</text><rect fill="#FEFECE" filter="url(#fow1z5arkmd7j)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="54" x="1311.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="40" x="1318.5" y="24.5332">Pulsar</text><rect fill="#FEFECE" filter="url(#fow1z5arkmd7j)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="54" x="1311.5" y="1183.1172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="40" x="1318.5" y="1204.6504">Pulsar</text><rect fill="#FEFECE" filter="url(#fow1z5arkmd7j)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="51" x="1379.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="1386.5" y="24.5332">SABR</text><rect fill="#FEFECE" filter="url(#fow1z5arkmd7j)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="51" x="1379.5" y="1183.1172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="1386.5" y="1204.6504">SABR</text><rect fill="#FFFFFF" filter="url(#fow1z5arkmd7j)" height="1103.1563" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="292.5" y="71.9609"/><rect fill="#FFFFFF" filter="url(#fow1z5arkmd7j)" height="1072.8047" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="434" y="102.3125"/><polygon fill="#A80036" points="280.5,67.9609,290.5,71.9609,280.5,75.9609,284.5,71.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="49.5" x2="286.5" y1="71.9609" y2="71.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="56.5" y="67.1045">BuildSABR</text><polygon fill="#A80036" points="422,98.3125,432,102.3125,422,106.3125,426,102.3125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="302.5" x2="428" y1="102.3125" y2="102.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="309.5" y="97.4561">build(SABR1)</text><path d="M359,117.3125 L420,117.3125 L420,125.3125 L410,135.3125 L359,135.3125 L359,117.3125 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="64.9609" style="stroke: #000000; stroke-width: 2.0;" width="322.5" x="359" y="117.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="374" y="131.8076">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="132" x="435" y="130.7314">[SABR1 does not exists]</text><polygon fill="#A80036" points="596.5,154.0156,606.5,158.0156,596.5,162.0156,600.5,158.0156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="444" x2="602.5" y1="158.0156" y2="158.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36" x="451" y="153.1592">create</text><rect fill="#90EE90" filter="url(#fow1z5arkmd7j)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="59" x="608.5" y="135.6641"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="615.5" y="157.1973">SABR1</text><polygon fill="#A80036" points="174.5,207.625,164.5,211.625,174.5,215.625,170.5,211.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="168.5" x2="433" y1="211.625" y2="211.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="172" x="180.5" y="206.7686">getRegistrationCreds(SABR1)</text><polygon fill="#A80036" points="628,237.9766,638,241.9766,628,245.9766,632,241.9766" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="444" x2="634" y1="241.9766" y2="241.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="172" x="451" y="237.1201">storeRegistrationCreds(creds)</text><polygon fill="#A80036" points="174.5,268.3281,164.5,272.3281,174.5,276.3281,170.5,272.3281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="168.5" x2="433" y1="272.3281" y2="272.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="180.5" y="267.4717">getBootstrapKey</text><polygon fill="#A80036" points="628,298.6797,638,302.6797,628,306.6797,632,302.6797" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="444" x2="634" y1="302.6797" y2="302.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="137" x="451" y="297.8232">storeKey(bootstrapKey)</text><polygon fill="#A80036" points="174.5,329.0313,164.5,333.0313,174.5,337.0313,170.5,333.0313" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="168.5" x2="639" y1="333.0313" y2="333.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="180.5" y="328.1748">registerEntity(SABR1)</text><polygon fill="#A80036" points="628,364.3828,638,364.3828,628,368.3828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="163.5" x2="639" y1="363.3828" y2="363.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="57" x="170.5" y="358.5264">deviceUID</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="640" x2="682" y1="393.7344" y2="393.7344"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="682" x2="682" y1="393.7344" y2="406.7344"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="641" x2="682" y1="406.7344" y2="406.7344"/><polygon fill="#A80036" points="651,402.7344,641,406.7344,651,410.7344,647,406.7344" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="647" y="388.8779">createUniqueAuthenticationKey</text><polygon fill="#A80036" points="174.5,438.0859,164.5,438.0859,174.5,442.0859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="163.5" x2="639" y1="437.0859" y2="437.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="180.5" y="432.2295">provision</text><rect fill="#EEEEEE" filter="url(#fow1z5arkmd7j)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1436.5" x="3" y="466.2617"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1439.5" y1="466.2617" y2="466.2617"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1439.5" y1="469.2617" y2="469.2617"/><rect fill="#EEEEEE" filter="url(#fow1z5arkmd7j)" height="24.3516" style="stroke: #000000; stroke-width: 2.0;" width="158" x="642.25" y="455.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="140" x="648.25" y="472.5811">Authenticate to Pulsar</text><polygon fill="#A80036" points="174.5,507.7891,164.5,511.7891,174.5,515.7891,170.5,511.7891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="168.5" x2="639" y1="511.7891" y2="511.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="71" x="180.5" y="506.9326">authenticate</text><polygon fill="#A80036" points="628,543.1406,638,543.1406,628,547.1406" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="163.5" x2="639" y1="542.1406" y2="542.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="170.5" y="537.2842">JWT</text><polygon fill="#A80036" points="1328.5,568.4922,1338.5,572.4922,1328.5,576.4922,1332.5,572.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="640" x2="1334.5" y1="572.4922" y2="572.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="647" y="567.6357">authenticate(JWT)</text><polygon fill="#A80036" points="174.5,598.8438,164.5,602.8438,174.5,606.8438,170.5,602.8438" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="168.5" x2="1339.5" y1="602.8438" y2="602.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="180.5" y="597.9873">validate(JWT)</text><rect fill="#EEEEEE" filter="url(#fow1z5arkmd7j)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1436.5" x="3" y="632.0195"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1439.5" y1="632.0195" y2="632.0195"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1439.5" y1="635.0195" y2="635.0195"/><rect fill="#EEEEEE" filter="url(#fow1z5arkmd7j)" height="24.3516" style="stroke: #000000; stroke-width: 2.0;" width="98" x="672.25" y="620.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="678.25" y="638.3389">Encrypt Data</text><polygon fill="#A80036" points="174.5,673.5469,164.5,677.5469,174.5,681.5469,170.5,677.5469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="168.5" x2="639" y1="677.5469" y2="677.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="334" x="180.5" y="672.6904">requestKeysDataStreamKeys(JWT,StreamID, timeRange)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="640" x2="682" y1="707.8984" y2="707.8984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="682" x2="682" y1="707.8984" y2="720.8984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="641" x2="682" y1="720.8984" y2="720.8984"/><polygon fill="#A80036" points="651,716.8984,641,720.8984,651,724.8984,647,720.8984" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="647" y="703.042">storeKeys</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="640" x2="682" y1="751.25" y2="751.25"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="682" x2="682" y1="751.25" y2="764.25"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="641" x2="682" y1="764.25" y2="764.25"/><polygon fill="#A80036" points="651,760.25,641,764.25,651,768.25,647,764.25" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="394" x="647" y="746.3936">createEnvelopeKey Data encryption key, Key Encryption Key KeyID</text><polygon fill="#A80036" points="651,790.6016,641,794.6016,651,798.6016,647,794.6016" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="645" x2="1406" y1="794.6016" y2="794.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="657" y="789.7451">encryptData</text><polygon fill="#A80036" points="651,820.9531,641,824.9531,651,828.9531,647,824.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="645" x2="1406" y1="824.9531" y2="824.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="249" x="657" y="820.0967">CreateNewMessage(encryptedData, keyID)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="640" x2="682" y1="855.3047" y2="855.3047"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="682" x2="682" y1="855.3047" y2="868.3047"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="641" x2="682" y1="868.3047" y2="868.3047"/><polygon fill="#A80036" points="651,864.3047,641,868.3047,651,872.3047,647,868.3047" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="647" y="850.4482">encryptData(key)</text><polygon fill="#A80036" points="1328.5,899.6563,1338.5,899.6563,1328.5,903.6563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="640" x2="1339.5" y1="898.6563" y2="898.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="177" x="647" y="893.7998">publish(JWT, message, keyID)</text><rect fill="#EEEEEE" filter="url(#fow1z5arkmd7j)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1436.5" x="3" y="927.832"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1439.5" y1="927.832" y2="927.832"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1439.5" y1="930.832" y2="930.832"/><rect fill="#EEEEEE" filter="url(#fow1z5arkmd7j)" height="24.3516" style="stroke: #000000; stroke-width: 2.0;" width="99" x="671.75" y="916.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="81" x="677.75" y="934.1514">Decrypt Data</text><polygon fill="#A80036" points="1328.5,974.3594,1338.5,974.3594,1328.5,978.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1048" x2="1339.5" y1="973.3594" y2="973.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="172" x="1055" y="968.5029">consume(JWT,DataStreamID)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1048" x2="1090" y1="1003.7109" y2="1003.7109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1090" x2="1090" y1="1003.7109" y2="1016.7109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1049" x2="1090" y1="1016.7109" y2="1016.7109"/><polygon fill="#A80036" points="1059,1012.7109,1049,1016.7109,1059,1020.7109,1055,1016.7109" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="1055" y="998.8545">haveKeyID</text><path d="M91,1031.7109 L152,1031.7109 L152,1039.7109 L142,1049.7109 L91,1049.7109 L91,1031.7109 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="92.0547" style="stroke: #000000; stroke-width: 2.0;" width="1035" x="91" y="1031.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="106" y="1046.2061">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="95" x="167" y="1045.1299">[do not have key]</text><polygon fill="#A80036" points="174.5,1068.4141,164.5,1072.4141,174.5,1076.4141,170.5,1072.4141" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="168.5" x2="1047" y1="1072.4141" y2="1072.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="313" x="180.5" y="1067.5576">getKeysDataStreamKeys(JWT, StreamID, timeRange)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1048" x2="1090" y1="1102.7656" y2="1102.7656"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1090" x2="1090" y1="1102.7656" y2="1115.7656"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1049" x2="1090" y1="1115.7656" y2="1115.7656"/><polygon fill="#A80036" points="1059,1111.7656,1049,1115.7656,1059,1119.7656,1055,1115.7656" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="1055" y="1097.9092">storeKeys</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1048" x2="1090" y1="1153.1172" y2="1153.1172"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1090" x2="1090" y1="1153.1172" y2="1166.1172"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1049" x2="1090" y1="1166.1172" y2="1166.1172"/><polygon fill="#A80036" points="1059,1162.1172,1049,1166.1172,1059,1170.1172,1055,1166.1172" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="1055" y="1148.2607">decrypt(key)</text><!--
@startuml
participant "Developer"
participant "SecurityManager" #pink
participant "DevOps Pipeline" as DevOps #00aaff
participant "Capability Manager" as CM #lightgreen
participant "SABR1" #lightgreen
participant "SABR2" #lightgreen
participant "DataStream1" #lightgreen
participant "DataStream2" #lightgreen

Developer -> DevOps : BuildSABR
activate DevOps
DevOps -> CM : build(SABR1)
alt SABR1 does not exists
activate CM
CM -> SABR1 ** : create
end
CM -> SecurityManager : getRegistrationCreds(SABR1)
CM -> SABR1 : storeRegistrationCreds(creds)
CM -> SecurityManager : getBootstrapKey
CM -> SABR1 : storeKey(bootstrapKey)

SABR1 -> SecurityManager : registerEntity(SABR1)
SecurityManager - -/ SABR1 : deviceUID
SABR1 -> SABR1 : createUniqueAuthenticationKey
SABR1 -/ SecurityManager: provision

== Authenticate to Pulsar ==

SABR1 -> SecurityManager : authenticate
SecurityManager - -/ SABR1 : JWT
SABR1 -> Pulsar : authenticate(JWT)
Pulsar -> SecurityManager : validate(JWT)

== Encrypt Data ==

SABR1 -> SecurityManager : requestKeysDataStreamKeys(JWT,StreamID, timeRange)
SABR1 -> SABR1 : storeKeys
SABR1 -> SABR1 : createEnvelopeKey Data encryption key, Key Encryption Key KeyID
SABR -> SABR1 : encryptData
SABR -> SABR1 : CreateNewMessage(encryptedData, keyID)
SABR1 -> SABR1 : encryptData(key)
SABR1 -/ Pulsar : publish(JWT, message, keyID)

== Decrypt Data ==

SABR2 -/ Pulsar : consume(JWT,DataStreamID)
SABR2 -> SABR2 : haveKeyID
alt do not have key
SABR2 -> SecurityManager: getKeysDataStreamKeys(JWT, StreamID, timeRange)
SABR2 -> SABR2 : storeKeys
end
SABR2 -> SABR2 : decrypt(key)

@enduml

PlantUML version 1.2019.05(Sat Apr 20 09:45:36 PDT 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 17.0.7+8-LTS-224
Operating System: Windows 11
OS Version: 10.0
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>